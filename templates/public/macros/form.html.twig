{# Builder macro used for above macros, not to be called directly. #}
{% macro build_input(props) %}

    {# Common styles #}
    {% set global = 'kd-leading-normal kd-border-solid kd-cursor-text kd-text-left kd-m-0 kd-placeholder-gray-500' %}
    {% set transition = 'kd-transition kd-transition-colors kd-ease-in-out kd-duration-75' %}
    {% set generic = 'kd-appearance-none kd-bg-transparent kd-border-gray-300 kd-border-solid kd-text-gray-700' %}
    {% set focus = 'focus:kd-outline-none focus:kd-border-primary' %}
    {% set styles = [] | merge([ global, generic, focus, props.class ]) %}

    {# Build input element #}
    <input
        name="{{ props.name }}"
        class="{{ styles | join(' ') }}"
        type="{{ props.type ?? 'text' }}"
        {% if props.placeholder %}
                placeholder="{{ props.placeholder ? props.placeholder ~ (props.required ? ' *') }}"
        {% endif %}
        {{ (props.required ? "required") }}
        {% for attr, value in props.atts %}
            {% if value %}
                {{ attr }}="{{ value }}"
            {% endif %}
        {% endfor %}
    >
{% endmacro %}

{# String base inputs (text, email, number #}
{% macro input(props) %}
    {% from _self import build_input %}

    {% set props = props|merge({
        class: "kd-order-1 kd-border-2 kd-py-2 kd-px-3 kd-rounded kd-w-full" ~ (props.label ? " kd-rounded-l-none")
    }) %}

    <label class="kd-flex kd-cursor-pointer kd-font-normal kd-mt-2 kd-w-full">
        {{ build_input(props) }}
        {% if props.label %}
            <span class="kd-text-gray-500 kd-m-0 kd-transition-shadow kd-transition-colors kd-ease-in-out kd-py-2 kd-px-3 kd-rounded-l kd-block kd-border-2 kd-border-r-0 kd-border-solid kd-border-gray-300">{{ props.label }}</span>
        {% endif %}
    </label>
{% endmacro %}

{# Radio inputs #}
{% macro radio(props) %}
    {% from _self import build_input %}

    {% set props = props|merge({
        type: 'radio',
        class: 'checked:kd-bg-primary kd-shadow-inner kd-rounded-full kd-border kd-border-primary kd-inline-block kd-w-4 kd-h-4 kd-m-2 kd-p-0 kd-ring-primary focus:kd-ring-2 kd-ring-offset-2',
    }) %}

    <div class="kd-flex kd-justify-center kd-items-center kd-mt-4">
        {% for value, label in props.options %}
            {% set newProps = props|merge({
                atts: {
                    value: value,
                    checked: (props.selected == value ? 'checked'),
                    'aria-label': label
                }
            }) %}
            <label
                    class="kd-flex kd-items-center kd-cursor-pointer kd-font-normal kd-mr-2 kd-mt-2">
                {{ build_input(newProps) }}
                {{ label }} {{ ('true' == required ? ' *') }}
            </label>
        {% endfor %}
    </div>
{% endmacro %}

{# Checkbox input #}
{% macro checkbox(props) %}
    {% from _self import build_input %}

    {% set props = props|merge({
        type: 'checkbox',
        class: 'kd-align-middle checked:kd-bg-primary kd-shadow-inner kd-border kd-border-primary kd-ring-primary focus:kd-ring-2 kd-ring-offset-2 kd-inline-block kd-w-4 kd-h-4 kd-m-2',
        value: 'true'
    }) %}

    <label class="kd-inline-block kd-items-center kd-cursor-pointer kd-font-normal kd-mr-2 kd-mt-2">
        {{ build_input(props) }}
        {{ props.label | wp_kses_post }} {{ ('true' == required ? ' *') }}
    </label>
{% endmacro %}

{# Radio inputs #}
{% macro radio_buttons(props) %}
    {% from _self import build_input %}
    {% set length = props.options|length %}

    <div class="kd-radio-buttons kd-flex kd-flex-row kd-flex-wrap kd--mx-2">
        {% for key,value in props.options %}
            {% set id = props.atts.id ~ '-' ~ key %}
            <div class="kudos-radio-amount kd-w-2/4 kd-mt-2 xs:kd-mb-0 {{ (length == 1 ? 'xs:kd-w-full' : length == 2 ? 'xs:kd-w-2/4' : length == 3 ? 'xs:kd-w-1/3' : length == 4 ? 'xs:kd-w-1/4' : '') }} kd-px-2 kd-m-0">
                {{ build_input(props|merge({
                    type: 'radio',
                    class: 'kd-opacity-0 focus:kd-shadow-none kd-absolute kd--z-1',
                    atts: {
                        value: value|replace({' ': ''}),
                        checked: (key==0 ? 'checked'),
                        id: id
                    }
                })) }}
                <label class="kd-m-0 kd-transition-shadow kd-transition-colors kd-ease-in-out kd-py-2 kd-rounded kd-cursor-pointer kd-text-center kd-block kd-border-2 kd-border-solid kd-border-gray-300"
                       for="{{ id }}">â‚¬{{ value }}</label>
            </div>
        {% endfor %}
    </div>
{% endmacro %}

{# Select box #}
{% macro select(props) %}

        <label class="kd-inline-block kd-relative kd-cursor-pointer kd-font-normal kd-mt-2 kd-w-full">
                <select
                        class="kd-appearance-none kd-leading-normal kd-bg-transparent kd-border-gray-300 kd-border-2 kd-border-solid focus:kd-border-primary kd-transition-colors kd-ease-in-out kd-rounded kd-w-full kd-py-2 kd-px-3 kd-text-gray-700"
                        {{ (props.required ? "required") }}
                        name="{{ props.name }}"
                        aria-label="{{ props.placeholder ?? props.label }}"
                >
                    <option value=""
                            disabled
                            selected>
                        {{ props.placeholder ? props.placeholder ~ (props.required ? ' *') }}
                    </option>
                    {% for value, text in props.options %}
                        <option value="{{ value }}">{{ text }}</option>
                    {% endfor %}
                </select>
                <svg class="kd-h-5 kd-w-5 kd-text-gray-500 kd-absolute kd-right-0 kd-mr-3 kd-bottom-1/2 kd-transform kd-translate-y-1/2"
                     xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd"
                          d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
                          clip-rule="evenodd"/>
                </svg>

        </label>
{% endmacro %}

{# Text area element #}
{% macro text_area(props) %}
    <label class="kd-inline-block kd-cursor-pointer kd-font-normal kd-mr-2 kd-mt-2 kd-w-full">
        <textarea
                name="{{ props.name }}"
                placeholder="{{ props.placeholder }}"
                aria-label="{{ props.placeholder ?? props.label }}"
                class="kd-cursor-text kd-appearance-none kd-leading-normal kd-bg-transparent kd-border-gray-300 kd-border-2 kd-border-solid kd-transition-colors kd-ease-in-out kd-rounded kd-w-full kd-py-2 kd-px-3 kd-text-gray-700 focus:kd-outline-none focus:kd-border-primary kd-leading-normal kd-ease-in-out kd-border-solid kd-cursor-pointer kd-text-left kd-m-0 kd-placeholder-gray-500 kd-transition kd-transition-colors kd-ease-in-out kd-duration-75"
                maxlength="255"
                rows="4" cols="50"
                {{ (props.required ? "required") }}
                {% for key, value in props.atts %}
                    {% if value %}
                        {{ key ~ '=' ~ value }}
                    {% endif %}
                {% endfor %}
        ></textarea>
    </label>
{% endmacro %}